$(document).ready(function(){function e(){w=o.height(),N=$(".TK-Hat").outerHeight()+$("#page-header").outerHeight(),y=$("#feedback-section").outerHeight()+$("footer").outerHeight(),H=w-(N+y),j=document.body.scrollHeight-y,T=o.scrollTop()+w}var t={},o=$(window),i={email:"",inaccurateContent:!1,inaccurateOutdatedContentText:"",otherMoreInformation:!1,otherMoreInformationText:"",textErrors:!1,typosLinksElementsText:"",outdatedSample:!1,inaccurateOutdatedCodeSamplesText:"",otherFeedback:!1,textFeedback:""};$("#feedback-checkbox-area").click(function(){$("span.k-tooltip-validation").remove()});var a=!1,n=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)})},d=function(e){"yesNoFeedback"===e&&(e=r);var t=document.cookie.match(new RegExp(e+"=([^;]+)"));if(t)return t[1]},c=$(location),r=c[0].origin+c[0].pathname,s=($("#popupNotification").kendoNotification().data("kendoNotification"),$("#feedback-form-popup-container").kendoNotification({appendTo:"#feedback-form-window"}).data("kendoNotification"),function(e,t){var o=d("uuid");o||(document.cookie="uuid="+n()+"; path=/"),"yesNoFeedback"===e&&(e=r),document.cookie=e+"="+t+";"}),u=$("#helpful-buttons-container"),l=$("#feedback-submitted-container"),f=function(e){e?(u.show(),l.hide()):(u.hide(),l.show())},k=function(){$("#feedback-container").hide()};d("yesNoFeedback")?k():f(!0);var b=$("#feedback-form-window").kendoWindow({actions:["Close"],draggable:!0,modal:!0,pinned:!1,visible:!1,title:!1,resizable:!1,width:"500px"}).data("kendoWindow"),m=$("#feedback-form"),h=kendo.observable(i),v=function(){var e=!0;for(var t in i)if("email"!==t){var o=h[t]===i[t];if(!o){e=!1;break}}return e},p=function(e,t){var o=h[e];return!o||t&&t.length>0};kendo.bind($("div#feedback-form-window"),h);var g=$("#feedback-checkbox-area").kendoValidator({validateOnBlur:!1,messages:{emptyForm:"You need to provide some feedback before submitting the form."},rules:{emptyForm:function(){return!v()}}}).data("kendoValidator"),x=$("#feedback-email-input").kendoValidator({validateOnBlur:!1,messages:{email:"Invalid email address."},rules:{email:function(e){if(e.val().length>0){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e.val())}return!0}}}).data("kendoValidator"),F=function(e,t){return $(e).kendoValidator({validateOnBlur:!1,messages:{emptyValidation:"Please provide some additional information.",htmlValidation:"HTML tags are not allowed in this field.",messageLength:"The message length must not exceed 2500 characters.",whiteSpaces:"Using only white spaces is not allowed in this field.",feedbackValidation:"Please select a category and provide some additional information."},rules:{emptyValidation:function(e){var o=e.val();return p(t,o)},htmlValidation:function(e){var t=e.val(),o=t.match(/(<([^>]+)>)/gi);return null==o},messageLength:function(e){var t=e.val();return!(t.length>2500)},whiteSpaces:function(e){var t=e.val();return!(t.length>0)||""!==$.trim(t)},feedbackValidation:function(e){var o=e.val();return!(o.length>0)||h[t]}}}).data("kendoValidator")};m.submit(function(e){e.preventDefault(),a||(a=!0,F("#feedback-code-sample-text-input","outdatedSample").validate()&&F("#feedback-more-information-text-input","otherMoreInformation").validate()&&F("#feedback-text-errors-text-input","textErrors").validate()&&F("#feedback-inaccurate-content-text-input","inaccurateContent").validate()&&F("#feedback-other-text-input","otherFeedback").validate()&&g.validate()&&x.validate()?(b.close(),s("submittingFeedback"),h.yesNoFeedback=d("yesNoFeedback")||"Not submitted",h.uuid=d("uuid"),h.path=r,h.sheetId=$("#hidden-sheet-id").val(),$.post("https://api.everlive.com/v1/lzrla9wpuk636rdd/functions/saveFeedback",h.toJSON(),function(){a=!1})):a=!1)}),$("#form-close-button").click(function(){b.close()}),$("#form-submit-button").click(function(){m.submit()}),$("#yesButton").click(function(){s("yesNoFeedback","Yes"),f(!1),t.closeFeedback(),t.hideFeedbackForm(),t.adjustNavigationPosition()}),$("#noButton").click(function(){s("yesNoFeedback","No"),f(!1),t.closeFeedback(),t.hideFeedbackForm(),t.adjustNavigationPosition(),b.center().open()}),$("#additional-feedback-button").click(function(){b.center().open()});var w=o.height(),N=$(".TK-Hat").outerHeight()+$("#page-header").outerHeight(),y=$("#feedback-section").outerHeight()+$("footer").outerHeight(),H=w-(N+y),j=document.body.scrollHeight-y,P=!d("yesNoFeedback")&&!d("yesNoFeedbackClosed"),_=!1,T=o.scrollTop()+w,V=!1;t=$.extend(t,{init:function(){t._events(),t.adjustArticleHeight(),e(),t.adjustNavigationPosition(),P&&(_=!0,window.setTimeout(function(){_=!1,t.adjustFeedbackPoistion(),t.adjustNavigationPosition()},1e4))},_events:function(){o.scroll(t._window_scroll),o.resize(t._window_resize),$("#close-button").click(t._button_click)},_window_scroll:function(){e(),T=o.scrollTop()+w,t.adjustFeedbackPoistion(),t.adjustNavigationPosition()},_window_resize:function(){e(),t.adjustArticleHeight(),t.adjustFeedbackPoistion(),t.adjustNavigationPosition()},_button_click:function(){t.closeFeedback(),t.adjustNavigationPosition()},adjustNavigationPosition:function(){var e=0;window.matchMedia("(max-width: 1200px)").matches||(e=Math.max(V?$("#feedback-section").outerHeight():0,T-j)),$("#page-nav").css("bottom",e)},adjustArticleHeight:function(){$("#page-article").css("min-height",H)},adjustFeedbackPoistion:function(){P&&!_&&(T-$("#feedback-section").outerHeight()<j?t.pinFeedback():t.unpinFeedback())},pinFeedback:function(){V=!0,$("#feedback-section").addClass("fixed"),$("#feedback-section-dummy").show()},unpinFeedback:function(){V=!1,$("#feedback-section").removeClass("fixed"),$("#feedback-section-dummy").hide()},closeFeedback:function(){P=!1,s("yesNoFeedbackClosed"),t.unpinFeedback()},hideFeedbackForm:function(){$("#feedback-section").addClass("hide-feedback-form")}}),t.init()});