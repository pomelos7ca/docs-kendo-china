<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <meta name="restype" content="documentation">
        <meta name="product" content="kendo-ui">
        
        <title>Part 2 - Hello Services | Kendo UI Third-Party Frameworks</title>
        <link rel="shortcut icon" href="/docs-kendo-china/favicon.ico"/>
        <meta name="description" content="Learn how to install the ASP.NET Web API, create services, supporting CRUD operations, and debug Web API Services.">
        <link href="//fonts.googleapis.com/css?family=Roboto:400,500,700,900" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700' rel='stylesheet' type='text/css'>
        <!-- <link href="https://kendo.cdn.telerik.com/2017.3.1026/styles/kendo.common.min.css" rel="stylesheet" /> -->
        <link rel="stylesheet" href="http://oygy5legq.bkt.clouddn.com/kendo.common.min.css">
        <link rel="stylesheet" href="/docs-kendo-china/assets/styles.css?cb=8338967476da1c756a6defe19c1f9984">
        <link rel="stylesheet" href="/docs-kendo-china/assets/icon-font.css?cb=25d8b9593057297c278fcd6d7d263c8e">
        <link rel="stylesheet" href="/docs-kendo-china/assets/theme.css?cb=d82da02940126146560da1ae3bb0bf64">
        
        <!-- <script src="https://code.jquery.com/jquery-1.10.2.js"></script> -->
        <script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
        <!-- <script src="https://kendo.cdn.telerik.com/2017.3.1026/js/kendo.web.min.js"></script> -->
        <script src="http://oygy5legq.bkt.clouddn.com/kendo.web.min.js"></script>
        <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/javascript/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/css/css.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/xml/xml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/htmlmixed/htmlmixed.min.js"></script> -->
        <script src="/docs-kendo-china/assets/prettify.js?cb=9671553084e1962263b152af1f563c3c"></script>
        <script src="/docs-kendo-china/assets/app.js?cb=b449339ba367b10f8b479f2e4faac62b"></script>
        
        

        <!--[if lt IE 9]>
        <script>
        document.createElement('header');
        document.createElement('nav');
        document.createElement('section');
        document.createElement('article');
        document.createElement('aside');
        document.createElement('footer');
        document.createElement('hgroup');
        </script>
        <![endif]-->
    </head>
    <body>
        <!-- Google Tag Manager -->
        <!-- <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script> -->
        <!-- End Google Tag Manager -->
        <aside class="TK-Hat">
    <figure class="TK-Hat-Brand">
        <a href="https://www.progress.com" class="TK-PRGS-Logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="94" height="40" viewBox="0 0 512 120">
                <path fill="#5ce500" d="M95.52 29.33v51a3.93 3.93 0 0 1-1.78 3.08l-1.67 1-12.72 7.35-8.59 5-1.78 1V42.6L21.23 15 43.91 1.93 46 .74a3.94 3.94 0 0 1 3.56 0L81 18.9l14.51 8.38v2.05zM58.36 48.72l-9.79-5.66-22.91-13.23a4 4 0 0 0-3.56 0L1.77 41.57 0 42.6l34.49 19.91v39.83l20.3-11.73 1.79-1a3.94 3.94 0 0 0 1.78-3.08V48.72zM0 82.43l23.86 13.78V68.63z"></path>
                <path fill="#4b4e52" d="M148.09 27.28h-26v70.48h11.55V70.1h14.57c15.77 0 24.45-7.7 24.45-21.69 0-6.35-2.4-21.12-24.55-21.12m12.78 21.31c0 7.95-4.12 11.19-14.24 11.19h-13v-22.1h14.57c8.56 0 12.71 3.57 12.71 10.91M207 46.41l.87.42-2 10.42-1.35-.42a11.32 11.32 0 0 0-3.34-.51c-10.79 0-11.67 8.59-11.67 19v22.44h-10.64V46h10v6.24c2.73-4.2 6-6.37 10.37-6.9a14.55 14.55 0 0 1 7.76 1.07M233.29 45c-8.42 0-15.16 3.2-19.5 9.27-4.56 6.37-5.23 13.85-5.23 17.74 0 16.36 9.7 26.92 24.73 26.92 18.26 0 24.73-14.71 24.73-27.3 0-7.25-2.15-13.82-6-18.51-4.41-5.31-10.87-8.12-18.7-8.12m0 44.38c-8.37 0-13.57-6.66-13.57-17.37s5.2-17.55 13.57-17.55S247 61.23 247 71.78c0 10.83-5.24 17.56-13.66 17.56m114.55-42.93l.87.42-2 10.42-1.35-.42a11.26 11.26 0 0 0-3.33-.51c-10.78 0-11.66 8.59-11.66 19v22.44h-10.66V46h10v6.24c2.73-4.2 6-6.37 10.37-6.9a14.54 14.54 0 0 1 7.73 1.06m38.4 34.76l-.2.57c-2.23 6.36-7.57 7.7-11.65 7.7-8.09 0-13.3-5.37-13.81-14.09h36.59l.13-1a31.26 31.26 0 0 0 .12-4.12v-.93C396.93 54.78 387.48 45 374 45c-7.9 0-14.37 3.1-18.73 9a30.85 30.85 0 0 0-5.54 18c0 16 9.95 26.74 24.74 26.74 11.45 0 19.33-5.82 22.2-16.38l.33-1.2h-10.7zM361 66.05c.9-7.17 5.81-11.73 12.79-11.73 5.33 0 11.64 3.1 12.52 11.73H361zm-60.7-15.71c-3.45-3.58-8.06-5.39-13.76-5.39-15.69 0-22.83 13.81-22.83 26.63 0 13.16 7.06 26.44 22.83 26.44a18.33 18.33 0 0 0 13.35-5.42c0 2.28-.1 4.45-.16 5.38-.58 8.54-4.68 12.51-12.91 12.51-4.47 0-9.61-1.59-10.6-6l-.22-1h-10.54l.17 1.41c1.1 9.12 9.11 14.79 20.9 14.79 10.34 0 17.7-3.9 21.28-11.26 1.73-3.55 2.6-8.72 2.6-15.37V46h-10.13v4.34zm-13.11 38.15c-3.74 0-12.43-1.69-12.43-17.37 0-10.3 4.87-16.7 12.71-16.7 6.06 0 12.52 4.39 12.52 16.7 0 10.87-4.79 17.37-12.81 17.37m159.67-6.31c0 8.23-6.83 16.53-22.09 16.53-13.5 0-21.53-5.85-22.61-16.45l-.15-1.1h10.52l.21.84c1.29 6.38 7.37 7.72 12.24 7.72 5.34 0 11-1.72 11-6.54 0-2.44-1.59-4.18-4.73-5.16-1.86-.55-4.15-1.2-6.56-1.87-4.16-1.16-8.47-2.38-11.12-3.29-6.56-2.35-10.33-6.93-10.33-12.56 0-10.43 10.16-15.11 20.22-15.11 13.46 0 20.42 5.07 21.3 15.49l.09 1.07H434.5l-.14-.82c-1-6-7-6.9-10.48-6.9-3 0-10 .53-10 5.5 0 2.25 1.93 3.91 5.89 5.06 1.18.33 2.94.78 5 1.31 4.22 1.09 9.48 2.46 12.13 3.37 6.59 2.32 9.93 6.67 9.93 13m49.39 0c0 8.23-6.83 16.53-22.09 16.53-13.5 0-21.53-5.85-22.61-16.45l-.11-1.09H462l.12.74c1.29 6.38 7.37 7.72 12.24 7.72 5.34 0 11-1.72 11-6.54 0-2.44-1.59-4.18-4.72-5.16-1.86-.55-4.15-1.2-6.57-1.87-4.16-1.16-8.46-2.38-11.11-3.29-6.57-2.35-10.33-6.93-10.33-12.56 0-10.43 10.16-15.11 20.22-15.11 13.46 0 20.42 5.07 21.29 15.49l.09 1.07H483.9l-.14-.82c-1-6-7-6.9-10.48-6.9-3 0-9.95.53-9.95 5.5 0 2.25 1.93 3.91 5.89 5.06 1.18.33 2.94.78 5 1.31 4.22 1.09 9.48 2.46 12.13 3.37 6.58 2.32 9.93 6.67 9.93 13m8.43-30.78a7.37 7.37 0 1 1 7.29-7.37 7.23 7.23 0 0 1-7.29 7.37m0-13.49a6.12 6.12 0 1 0 6 6.12 5.91 5.91 0 0 0-6-6.12m-.85 7.49v2.46h-2.17v-7.74h3.62a2.58 2.58 0 0 1 2.86 2.7 2.26 2.26 0 0 1-1.49 2.34l1.77 2.7H506l-1.49-2.46h-.68zm1.21-3.49h-1.21v1.73h1.21a.86.86 0 0 0 1-.85.88.88 0 0 0-1-.89"></path>
            </svg>
        </a>
    </figure>
</aside>
<header id="page-header">
    <div class="toggle-nav"><span class="k-icon k-i-menu"></span></div>


    <div id="logo-bar">
        <a href="/docs-kendo-china/introduction">
            <img alt="Kendo UI logo" class="logo" src="/docs-kendo-china/images/kendo-ui.svg">
        </a>
    </div>

    
    <span class="show-search">
        <span class="k-icon k-i-search"></span>
    </span>
    
    <div class="nav-buttons">
        <a href="http://demos.telerik.com/kendo-ui/" class="btn demos-btn">Demos</a>
        <a href="http://www.telerik.com/kendo-ui" class="btn about-btn">About</a>
        <a href="http://www.telerik.com/purchase/kendo-ui" class="btn pricing-btn">Pricing</a>
        <a href="http://www.telerik.com/download/kendo-ui" class="btn btn-primary">Try now</a>
    </div>
</header>
        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/docs-kendo-china/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            messages: {
                loading: " "
            },
            select: preventParentSelection,
            template: navigationTemplate("/docs-kendo-china/"),
            dataBound: expandNavigation("third-party/tutorials/webforms/asp-net-hello-services.html")
        });
        </script>
    </div>

    <a id="page-edit-link" href="https://github.com/telerik/kendo-ui-core/edit/master/docs//third-party/tutorials/webforms/asp-net-hello-services.md"><span class="k-icon k-i-pencil"></span> Edit this page</a>
    

    <div id="page-article">
        <article>
            
             <h1 id="part-2---hello-services"><a href="#part-2---hello-services">Part 2 - Hello Services</a></h1>

<p>This tutorial will walk you through the creation of RESTful services with ASP.NET Web API. In this second out of five parts you are going to learn:</p>

<ul>
<li>How to install ASP.NET Web API</li>
<li>How to create a service that supports CRUD (Create, Read, Update, Destroy) operations</li>
<li>How to wire up a web page to a Web API Service</li>
<li>How to debug Web API Services</li>
</ul>

<p>This module will cover how to create a RESTful service with <a href="http://www.asp.net/web-api">ASP.NET Web API</a>, and how to consume that service in JSON format with jQuery. There is also a very quick primer on the concept of REST and JSON, as well as a good look at using the <a href="http://msdn.microsoft.com/en-US/library/gg589512%28v=vs.85%29.aspx">IE F12 Developer Tools</a> to debug your application.</p>

<p>All code used in this module can be downloaded from the <a href="https://github.com/telerik/html5-dev-for-aspnet-devs">GitHub project course</a>. Feel free to download the finished product, or follow the screencast or the written content.</p>

<h2 id="screencast"><a href="#screencast">Screencast</a></h2>

<iframe width="640" height="360" src="http://www.youtube.com/embed/6RGS1ReBuPs?rel=0" frameborder="0"></iframe>

<h2 id="written-summary"><a href="#written-summary">Written Summary</a></h2>

<p>In this tutorial, you are going to build a sample application which displays data from an SQL Server table using AJAX to fetch the data from a Web API service. You will also add CRUD abilities to both the UI and the service while learning how to stay RESTful with your service implementation.</p>

<h2 id="quick-primer-on-rest-and-json"><a href="#quick-primer-on-rest-and-json">Quick Primer on REST and JSON</a></h2>

<p><a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> stands for Representational State Transfer. It is a pattern for developing services which lets the HTTP requests describe what sort of action should be done, and what format the data should be in and it allows the server to indicate success or failure by using HTTP codes. Through applying this strategy, it is easy to construct very predictable URLs from web services so that consuming them becomes much easier. There is much more to REST than that short explanation, but this tutorial tries to stay as RESTful as possible.</p>

<p><a href="http://www.json.org/">JSON</a> is an acronym that stands for JavaScript Object Notation. This is a way of <a href="http://en.wikipedia.org/wiki/Serialization">serializing</a> data and objects into a very simple and easy to understand string representation. The JSON format is not only easily consumable by JavaScript, but is also much easier for humans to read and debug.</p>

<h2 id="create-sample-application"><a href="#create-sample-application">Create Sample Application</a></h2>

<p>Open Visual Studio. Select <strong>File/New Project</strong> and select the <strong>ASP.NET Web Application</strong> template. Name the application <strong>HelloServices</strong>.</p>

<p><strong>Figure 1: Filing a new project</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-file-new-project.png" alt="File New Project"></p>

<p>Open the <strong>Default.aspx</strong> page and delete all the content.</p>

<h3 id="project-structure"><a href="#project-structure">Project Structure</a></h3>

<p>Before proceeding with this project, create some structure for the application to keep it organized. Create a folder called <code>Data</code> directly under the main project which will hold the data access layer. Create a second folder called <code>Controllers</code> which will hold the Web API service that will be created in this tutorial.</p>

<p><strong>Figure 2: Data controllers</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-data-controllers.png" alt="Data Controllers"></p>

<h3 id="create-data-access-layer"><a href="#create-data-access-layer">Create Data Access Layer</a></h3>

<p>The <a href="http://www.microsoft.com/en-us/download/details.aspx">Northwind Database project</a> is going to be used for the purpose of this tutorial and <a href="http://msdn.microsoft.com/en-us/library/bb425822.aspx">LINQ To SQL</a> is going to be applied as the Data Access layer because of its simplicity and ease of use. Make sure you install the <a href="http://www.microsoft.com/en-us/download/details.aspx">Northwind Database</a> before proceeding.</p>

<p>Right-click the <code>Data</code> folder. Select <strong>Add New Item</strong> &gt; <strong>LINQ To SQL Classes</strong>. Give the <code>dbml</code> file the name <code>NorthwindContext.dbml</code> Click <strong>Add</strong>. This will bring up the <strong>LINQ To SQL</strong> designer surface. Open the <strong>Servers Explorer</strong> window either from the left-hand side, or from the <strong>View</strong> menu. Expand the <strong>Northwind</strong> database and expand <strong>Tables</strong>. Drag the <strong>Employees</strong> table onto the design surface. Save the file.</p>

<p><strong>Figure 3: Adding LINQ to SQL</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-add-linq-to-sql.png" alt="Add Linq To Sql"></p>

<p><strong>Figure 4: Added LINQ to the SQL Table</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-linq-to-sql-table-added.png" alt="Linq To Sql Table Added"></p>

<h3 id="install-nuget-packages"><a href="#install-nuget-packages">Install NuGet Packages</a></h3>

<h4>Install Web API</h4>

<p>Before the service that returns the data from the database can be created, make sure you install Web API from <a href="http://nuget.org/">NuGet</a>.</p>

<p>Right-click the project and select <strong>Add Library Package Reference</strong>. When the dialogue comes up, click the <strong>online</strong> tab on the left-hand side and enter <code>aspnetwebapi</code> in the search box. Select <strong>AspNetWebApi</strong> from the search result and click the <strong>Install</strong> button. Accept the package dependencies and install those as well.</p>

<p><strong>Figure 5: Nuget ASP.NET Web API</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-nuget-aspnetwebapi.png" alt="Nuget AspNetWebApi"></p>

<h4>Install jQuery</h4>

<p>Enter <code>jquery</code> in the <strong>Search</strong> box. Select <strong>jQuery</strong> and then <strong>Install</strong>.</p>

<p><strong>Figure 6: Installing jQuery</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-install-jquery.png" alt="Install jQuery"></p>

<p>Close the <strong>Add Library Package Reference</strong> dialogue.</p>

<h3 id="create-web-api-service"><a href="#create-web-api-service">Create Web API Service</a></h3>

<p>To create the Web API Service, an empty class is needed. Right-click the <code>Controllers</code> folder. Select <strong>Add</strong> &gt; <strong>Class</strong>. Name the class <code>EmployeesController.cs</code></p>

<p><strong>Figure 7: Employees Controller</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-employees-controller.png" alt="Employees Controller"></p>

<p>To designate the <code>EmployeesController.cs</code> class that was just added as a Web API controller that will respond to requests, inherit from the <code>ApiController</code> class. If <code>ApiController</code> is not recognized for you, hover over the word until you get the context menu. This will give you the option to include <code>System.Web.Http</code>. Optionally, you can achieve the same result by pressing <code>Alt</code>+<code>Shift</code>+<code>F10</code>, which brings up the same context menu.</p>

<p><strong>Figure 8: Employee controller inheriting the API controller class</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-employee-controller-class-inherit.png" alt="Employee Controller Inherits ApiController Class"></p>

<p>This class will contain methods that can be invoked from the web service that is being created. This service represents the <strong>Employees</strong> table in the <a href="http://www.microsoft.com/en-us/download/details.aspx">Northwind Database</a>. This is the table that is going to be used in this tutorial for data.</p>

<p>A typical RESTful endpoint will respond to the following HTTP verbs:</p>

<ol>
<li>
<code>GET</code> - Used when a browser is requesting data from the server.</li>
<li>
<code>PUT</code> - Typically used when updating an item.</li>
<li>
<code>POST</code> - Typically used when creating a new item.</li>
<li>
<code>DELETE</code> - Used when deleting an item.</li>
</ol>

<p>To start with, create a <code>get</code> method. This method returns all of the data in the <strong>Employees</strong> table in the Northwind Database. Name the method <code>Get()</code>. The method should return a list of <code>Data.Employee</code> objects. The <code>Data.Employee</code> object is created automatically for you by LINQ To SQL when the <strong>Employees</strong> table was added to the LINQ To SQL designer surface.</p>

<p>Create an instance of the <code>Data.NorthwindDataContext</code> at the top of the file and name it <code>_context</code> This is the object that is used to query the database.</p>

<p>Inside the <code>Get()</code> method, write a simple LINQ query to retrieve all employees from the <strong>Employees</strong> table.</p>

<p>The example below demonstrates the LINQ query to select all employees.</p>

<h6>Example</h6>

<pre><code>public List&lt;Data.Employee&gt; Get() {

    var employees = from e in _context.Employees
                    select e;

    return employees.ToList();

}
</code></pre>

<!--_-->

<p>Since Web API operates on convention over configuration, simply naming this method <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">Get</a> is enough to designate as the method that will respond to the HTTP GET.</p>

<p><strong>Figure 9: Returning a LINLINQ to the SQL object</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-return-linq-object.png" alt="Return A LinqToSql Object"></p>

<p>You can override this convention by specifying to the verb you want a method to respond to by decorating the method with the correct attribute (i.e. <code>HttpPut</code>).</p>

<h3 id="set-up-routing"><a href="#set-up-routing">Set Up Routing</a></h3>

<p>Before Web API can return results via a URL, a route needs to be set up, so that the application knows to map a specific route back to the <code>EmployeesController.cs</code> file in the <code>Controllers</code> folder.</p>

<p>Open the <code>Global.asax</code> file. Under the <code>Application_Start</code> method, add the following code demonstrated in the example below.</p>

<h6>Example</h6>

<pre><code>void Application_Start(object sender, EventArgs e) {

    // intialize the default routing configuration

    RouteTable.Routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = System.Web.Http.RouteParameter.Optional });
}
</code></pre>

<p>This block initializes routing for Web API. This is how it knows to route URLs to certain controllers. In this case, the default route says that anything coming after <code>/api</code> on the root should be routed to a controller. It is also passing an optional <code>id</code> parameter to the end of the URL. If the <code>id</code> is passed, it is handed off to the proper method. If nothing is passed, it is ignored. This means that the route for the <code>EmployeesController</code> will be something like <a href="http://yourserver/api/employees">http://your-server/api/employees</a>.</p>

<h4>Test the Application</h4>

<p>Press <code>F5</code> to build and run the application. You will notice that the application throws an error that is somewhat obscure. If you inspect the details of that error, it will tell you that it cannot serialize the LINQ To SQL object.</p>

<p><strong>Figure 10: Serialization error</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-serialization-error.png" alt="Serialization Error"></p>

<p>This is because .NET cannot serialize the LINQ To SQL object that is being returned by the <code>Get()</code> method in the <code>EmployeesController.cs</code> file. LINQ To SQL Objects are rather complex and contain far more information than what is actually needed by the UI, which is the raw data.</p>

<h3 id="add-model"><a href="#add-model">Add Model</a></h3>

<p>To get the raw data out of the LINQ To SQL objects and into a format that .NET can easily serialize, you will create a model object which will represent one row in the <code>Employees</code> table. This model will have properties that mirror the columns in the <strong>Employees</strong> table. For the sake of brevity, add only three properties to the model.</p>

<p>Right-click the project in Visual Studio and select <strong>Add Folder</strong>. Name this folder <code>Models</code>. Right-click the <code>Models</code> folder. Select <strong>Add</strong> &gt; <strong>Class</strong>. Optionally, you can achieve the same effect by pressing <code>Shift</code>+<code>Alt</code>+<code>C</code>. Name this class <code>Employee</code>. In the <code>Employee</code> class, which is now in the <code>Models</code> folder, add three properties. One for the employee ID, first name, and last name.</p>

<p>The example below demonstrates the <code>Employee</code> model object.</p>

<h6>Example</h6>

<pre><code>public class Employee {

    public int Id { get; set; }

    public string FirstName { get; set; }

    public string LastName { get; set; }

}
</code></pre>

<p><strong>Figure 11: Employee model</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-employee-model.png" alt="Employee Model"></p>

<p>Open up the <code>EmployeesController.cs</code> file in the <code>Controllers</code> folder. Alter the <code>Get()</code> method to return a list of <code>Model.Employee</code> objects instead of a list of <code>Data.Employee</code> objects. Also alter the LINQ To SQL Query so that it selects a new <code>Employee</code> model object for each row returned from the database.</p>

<p>The example below demonstrates how to return a list of <code>Employee</code> model objects.</p>

<h6>Example</h6>

<pre><code>public List&lt;Model.Employees&gt; Get() {

    // select a new model object for each row in the
    // linq query result

    var employees = from e in _context.Employees
                    select new Models.Employee {
                        Id = e.EmployeeID,
                        FirstName = e.FirstName,
                        LastName = e.LastName
                    };

    return employees.ToList();

}
</code></pre>

<!--_-->

<p><strong>Figure 12: Web get</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-web-get.png" alt="Web Get"></p>

<h4>Test the Application</h4>

<p>Press <code>F5</code> to run the application again. Navigate to the <strong>api/employees</strong> URL. Notice that Web API returns the records from the Northwind Employees table in XML format. Internet Explorer will try to download the file, but other browsers, such as Chrome, will display the results.</p>

<p><strong>Figure 13: Employees XML</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-employees-xml.png" alt="Employees XML"></p>

<h3 id="get-json-data-with-ajax"><a href="#get-json-data-with-ajax">Get JSON Data With AJAX</a></h3>

<p>Now that data is being returned by the service, it is possible to use jQuery to call that service with [AJAX](<a href="http://en.wikipedia.org/wiki/Ajax_(programming)">http://en.wikipedia.org/wiki/Ajax_(programming)</a> and get the results in JSON format instead of XML. Once the data has been retrieved as JSON, it is much easier to work with it and create a user interface. For this demonstration, you are going to retrieve the list of employees and display each employee in an HTML table row.</p>

<h3 id="add-jquery-to-project"><a href="#add-jquery-to-project">Add jQuery to Project</a></h3>

<p>Open the <code>Site.Master</code> file and drag the <code>jquery.min</code> file over to the page just below the <code>Site.css</code> link tag in the head of the page. At the time of this writing, the current version of jQuery is <code>jquery-1.9.1.min.js</code></p>

<p><strong>Figure 14: Adding jQuery to the master page</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-add-jquery-to-master-page.png" alt="Add jQuery To Master Page"></p>

<p>Open up the <code>Default.aspx</code> file. Create an HTML <code>table</code> element with an <code>employees</code> id, as demonstrated in the example below.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;
</code></pre>

<p>Below the <code>table</code> element that you just created, but before the closing <code>content</code> tag, open a new script block as demonstrated in the example below.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // jquery ajax code will go here

&lt;/script&gt;
</code></pre>

<p>Inside the script block create a <a href="http://api.jquery.com/ready/">jQuery <code>Document Ready</code></a> function. This is the function that executes when the entire page has loaded, including all HTML, CSS, and included JavaScript files.</p>

<p>Inside the <code>Document Ready</code> function, select the HTML table with the <code>employees</code> id from the <a href="http://en.wikipedia.org/wiki/Document_Object_Model">DOM</a> and assign it to a variable <code>$employees</code> call for later use. It is considered a good practice by some to prefix variables containing jQuery objects with a <code>$</code> so that you know that the variable represents a jQuery wrapped object when you see it later down in the code. The table is selected by its ID by using the jQuery ID Selector](<a href="http://api.jquery.com/id-selector/">http://api.jquery.com/id-selector/</a>) (the number (<code>#</code>) sign).</p>

<p>The example below demonstrates how to select a table when the document is ready.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // document ready function

    $(function() {

        // select the employees table from the page and
        // store it in a variable for later use.
        var $employees = $("#employees");

    });

&lt;/script&gt;
</code></pre>

<h3 id="make-ajax-calls"><a href="#make-ajax-calls">Make AJAX Calls</a></h3>

<p>[AJAX](<a href="http://en.wikipedia.org/wiki/Ajax_(programming)">http://en.wikipedia.org/wiki/Ajax_(programming)</a> is an acronym that stands for Asynchronous JavaScript And XML. However, it has come to take on a much broader and less specific meaning. AJAX generally refers to the action of making a request to the server in the background and receiving a result. This is different from the typical browser request/response communication in that it happens without any visual indication that anything has taken place. It is absolutely silent unless the UI is built to show background requests. Additionally, XML is rarely used anymore for AJAX operations. It is most common now to use <a href="http://www.json.org/">JSON</a>, which is an incredibly simple form of serialization that is very easy to manipulate with JavaScript. Web API supports rendering in JSON with the new <a href="http://msdn.microsoft.com/en-us/library/system.json%28v=vs.95%29.aspx">System.Json</a> library.</p>

<p>One of the things that makes <a href="http://jquery.com/">jQuery</a> so desirable, is that it makes AJAX very trivial for a developer to implement. To make an AJAX call to the Web API Employee service, use the jQuery <a href="http://api.jquery.com/jQuery.ajax/"><code>.ajax()</code></a> function. This function takes an object that contains the parameters for configuring the AJAX request. For the request to the <code>api/employees</code> endpoint, the configuration object needs you to specify the <code>url</code>, <code>contentType</code>, and <code>success</code> options.</p>

<ul>
<li>
<code>url</code> - This option will be specified as the string <code>api/employees</code>. This URL is a relative path, so there is no need to specify the full URL.</li>
<li>
<code>contentType</code> - Since it is much easier to work with JSON, the AJAX request needs to specify that the data should be in JSON format. This is done by setting the HTTP Header content type to <code>application/json</code>. When using jQuery, this is done simply by setting <code>contentType</code> to <code>json</code>.</li>
<li>
<code>success</code> - This is the function that is called when the server returns a response to the AJAX call. The function takes in a data parameter, which holds the JSON response returned from the employees web service.</li>
</ul>

<p>The example below demonstrates how to make an AJAX call for employees data in JSON format.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // document ready function
    $(function() {

        // select the employees table from the page and
        // store it in a variable for later use
        var $employees = $("#employees");

        // make an AJAX call to the employees Web API service
        // to retrieve a JSON response of all the employees
        $.ajax({

            // the URL to the service
            url: "api/employees",

            // the format that the data should be in when
            // it is returned
            contentType: "json",

            // the function that executes when the server
            // responds to this AJAX request successfully
            success: function(data) {

                // put the JSON response in the Employees table

            }

        });

    });

&lt;/script&gt;
</code></pre>

<p>To put the data returned into the page, iterate over the results returned by the server. This is done using the jQuery <a href="http://api.jquery.com/each/"><code>.each()</code></a> function. As each item is iterated over, a new row is added to the <code>Employees</code> HTML table by using the <a href="http://api.jquery.com/append/">jQuery <code>append()</code></a> method. The table variable is used instead of selecting the table each time in the loop. Selecting an item once from the DOM and referencing it in a variable is better for performance and cuts down on code clutter.</p>

<p>The example below demonstrates how to make an AJAX call fir the employees data in JSON format.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // document ready function

    $(function() {

        // select the Employees table from the page and
        // store it in a variable for later use.
        var $employees = $("#employees");


        // make an AJAX call to the employees Web API service
        // to retrieve a JSON response of all the employees
        $.ajax({

            // the URL to the service
            url: "api/employees",

            // the format that the data should be in when
            // it is returned
            contentType: "json",

            // the function that executes when the server
            // responds to this AJAX request successfully
            success: function(data) {

                // iterate over the data items returned from the server
                // the index variable is the position in the collection.
                // the item variable is the item itself
                $.each(data, function(index, item){

                    // append the first and last name to the table
                    $employees.append("&lt;tr&gt;&lt;td&gt;" + item.FirstName + "&lt;/td&gt;" +
                                          "&lt;td&gt;" + item.LastName + "&lt;/td&gt;");

                });

              }

        });

    });

&lt;/script&gt;
</code></pre>

<h4>Test the Application</h4>

<p>Press <code>F5</code> to run the application, or if your application is still running, save the file and refresh the page or point the page at the <code>Default.aspx</code> URL. Since all the changes were made in JavaScript, it is not necessary to stop and start the application.</p>

<p>Notice that the application shows the employees in a list. Press <code>F12</code> to open the developer tools. Click the network tab and then <strong>Start Capturing</strong>. Refresh the page. The request that is made to <strong>api/employees</strong>. Double-click the request. The <code>Content-Type</code> is set to <code>JSON</code>.</p>

<p><strong>Figure 15: F12 content type inspection</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-f12-content-type-json.png" alt="F12 Content Type Inspection"></p>

<p>Select the <strong>Response body</strong> tab. Inspect the JSON response returned from the server.</p>

<p><strong>Figure 16: F12 response body</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-f12-response-body-json.png" alt="F12 Response Body"></p>

<h3 id="enable-deletion-of-employees"><a href="#enable-deletion-of-employees">Enable Deletion Of Employees</a></h3>

<p>Switch back to Visual Studio and the <code>Default.aspx</code> page. In order to add the ability to delete employees from the UI, its necessary to add a button out to the right-hand side of each row. This could be done by adding more HTML inside the <code>each()</code> loop. However, this is already a bit messy. There is HTML in the JavaScript and adding to this would make it worse. Generally, it is a best practice not to include HTML inside the JavaScript this way.</p>

<h3 id="use-templates"><a href="#use-templates">Use Templates</a></h3>

<p>To clean this up and make it better, it is a good idea to use the templating concept. This is the idea of having a single table row which is created once and then copied for each element in the dataset and appended to the table. There are many forms of templating and some libraries that make this much simpler. This is explored in more detail in later modules.</p>

<p>For this example, a very basic form of manual templating is demonstrated. The idea here is to add a block of HTML that is not visible on the page, but can be used to dynamically create HTML elements. Specifically, a table row is needed. This implementation involves adding a <code>div</code> with a <code>templates</code> id right after the closing script block. The style on this <code>div</code> will be set to <code>display: none</code>. This means that this <code>div</code> and all its content is not going to be displayed on the page. Inside this <code>div</code> create a table, then a single table row definition with a column for the first name, a column for the last name, and a column for the <strong>Delete</strong> button that contains a button. These elements will have classes and not ids since they are going to be used over and over again.</p>

<p>The example below demonstrates how to create a block of template HTML.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // document ready function
    $(function() {

        // select the Ð•mployees table from the page and
        // store it in a variable for later use.
        var $employees = $("#employees");

        // make an AJAX call to the employees Web API service
        // to retrieve a JSON response of all the employees
        $.ajax({

            // the URL to the service
            url: "api/employees",

            // the format that the data should be in when
            // it is returned
            contentType: "json",

            // the function that executes when the server
            // responds to this AJAX request successfully
            success: function(data) {

                // iterate over the data items returned from the server
                // the index variable is the position in the collection
                // the item variable is the item itself
                $.each(data, function(index, item){

                        // append the first and last name to the table
                        $employees.append("&lt;tr&gt;&lt;td&gt;" + item.FirstName + "&lt;/td&gt;" +
                                              "&lt;td&gt;" + item.LastName + "&lt;/td&gt;");

                });

            }

        });
    });

 &lt;/script&gt;

&lt;div id="templates" style="display: none"&gt;

    &lt;table&gt;

        &lt;tr class="row-template"&gt;
            &lt;td class="firstName" style="width: 100px;"&gt;&lt;/td&gt;
            &lt;td class="lastName" style="width: 100px;"&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;input type="button" value="X" class="delete" /&gt;
            &lt;/td&gt;
        &lt;/tr&gt;

    &lt;/table&gt;

&lt;/div&gt;
</code></pre>

<p>Inside of the <code>each()</code> loop, select the <strong>templates</strong> <code>div</code> by its id. Then use the <a href="http://api.jquery.com/find/">jQuery <code>.find()</code></a> method to select the row by its class. This will find the items in the children of the <strong>templates</strong> <code>div</code> with the specified selector. Once the table row is selected, call the <a href="http://api.jquery.com/clone/">jQuery <code>clone()</code></a> method. This will create a new object of the same type that was just selected (a table row), and store it in the variable.</p>

<p>In jQuery this is called Chaining. This is when methods are called on methods because each method returns an object, allowing you to continue to call methods on the same line. Once the row template has been created, find the first and last name columns and set their <a href="http://api.jquery.com/html/"><code>.html()</code></a> with the first and last name from the returned JSON data. Then select the button by its class and add a <code>click</code> event.</p>

<p>Inside the <code>click</code> event, create another <code>ajax()</code> method. The URL will be the same as the first <code>ajax()</code> method with the exception that the current item id is appended onto the end. This creates a RESTful URL. The <code>type</code> should be set to <code>delete</code>. In the <code>success</code> function, simply remove the item from the page by calling the <a href="http://api.jquery.com/remove/">jQuery <code>.remove()</code></a> function. This will reflect the database change in the user interface. Lastly, right before the closing bracket for the <code>each()</code> loop, append the row to the table.</p>

<p>The example below demonstrates how to create a block of template HTML.</p>

<h6>Example</h6>

<pre><code>&lt;table id="employees"&gt;&lt;/table&gt;

&lt;script&gt;

    // document ready function
    $(function() {

        // select the Employees table from the page and
        // store it in a variable for later use
        var $employees = $("#employees");

        // make an AJAX call to the employees Web API service
        // to retrieve a JSON response of all the employees
        $.ajax({

            // the URL to the service
            url: "api/employees",

            // the format that the data should be in when
            // it is returned
            contentType: "json",

            // the function that executes when the server
            // responds to this AJAX request successfully
            success: function(data) {

                // iterate over the data items returned from the server
                // the index variable is the position in the collection
                // the item variable is the item itself
                $.each(data, function(index, item){

                    // create a row template
                    var $row = $("#templates").find(".row-template").clone();

                    // set the first and last name column text for the row
                    $row.find(".firstName").html(item.FirstName);
                    $row.find(".lastName").html(item.LastName);

                    // find the button and set its click event
                    $row.find(".delete").click(function() {

                    // call the delete method on the employees service

                    $.ajax({
                        // append the current employee id onto the URL
                        url: "api/employees/" + item.Id,

                        // set the request type to be a DELETE
                        type: "DELETE",

                        // remove the row on a success response from the server
                        success: function() {
                            $row.remove();
                        }
                    });

                    // append the row to the table
                    $employees.append($row);
                });

            }
        });

    });

&lt;/script&gt;

&lt;div id="templates" style="display: none"&gt;

    &lt;table&gt;

        &lt;tr class="row-template"&gt;
            &lt;td class="firstName" style="width: 100px;"&gt;&lt;/td&gt;
            &lt;td class="lastName" style="width: 100px;"&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;input type="button" value="X" class="delete" /&gt;
            &lt;/td&gt;
        &lt;/tr&gt;

    &lt;/table&gt;

&lt;/div&gt;
</code></pre>

<h4>Test the Application</h4>

<p>Press <code>F5</code> to run the application. Open the Developer Tools in Internet Explorer by pressing <code>F12</code>. Switch to the network tab and click <strong>Start Capturing</strong>. Notice that when the <strong>Delete</strong> button is clicked, an AJAX request is fired to the server with a <code>delete</code> method. The server is currently returning a 404, because the <code>delete</code> method has not yet been created in the service.</p>

<p><strong>Figure 17: Deleting not implemented</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-delete-not-implemented-404.png" alt="Delete Not Implemented"></p>

<h3 id="add-delete-method">
<a href="#add-delete-method">Add </a><code>Delete</code> Method</h3>

<p>Switch back to Visual Studio and stop the application. Open up the <code>EmployeesController.cs</code> file in the <code>Controllers</code> folder. Create a void method underneath the <code>Get()</code> method called <code>Delete()</code> which takes in an <code>id</code> parameter of <code>int</code> type, as demonstrated in the example below.</p>

<h6>Example</h6>

<pre><code>public void Delete(int id) {

    // code to delete employee by id goes here

}
</code></pre>

<p>Inside the <code>Delete()</code> method, select the employee to delete by its id from the LINQ to SQL context. Delete the employee and submit the changes by using LINQ To SQL. The <code>id</code> parameter is passed along by the default routing that was set up in the <code>Global.asax</code>. Since the method is named <code>Delete()</code> it responds to an HTTP <strong>DELETE</strong> verb.</p>

<p>The example below demonstrates how to delete an employee by using LINQ To SQL.</p>

<h6>Example</h6>

<pre><code>public void Delete(int id) {

    // select the employee from the database by its id
    var employeeToDelete = (from e in _context.Employees
                            where e.EmployeeID == id
                            select e).FirstOrDefault();

    // delete the employee from the context
    _context.Employees.DeleteOnSubmit(employeeToDelete);

    // submit the changes
    _context.SubmitChanges();

}
</code></pre>

<!--_-->

<p>Add yourself as an employee in the Northwind <strong>Employees</strong> table by providing just your last and first name. The other employees cannot be deleted due to existing relationships in other tables.</p>

<h4>Run the Application</h4>

<p>Press <code>F5</code> to run the application. Press <code>F12</code> to open the Developer Tools. Switch to the <strong>Network</strong> tab and click <strong>Start Capturing</strong>. Click <strong>Delete</strong> next to the name you added to the database. Notice that the <code>delete</code> AJAX request happens and a <code>200</code> is returned from the server. This means that the item has been successfully deleted from the database. Also notice that your name was removed from the page by jQuery.</p>

<p><strong>Figure 18: Final result</strong></p>

<p><img src="/docs-kendo-china/images/webforms/hello-services-finally.png" alt="Finally"></p>

<h2 id="further-reading"><a href="#further-reading">Further Reading</a></h2>

<p>Web API is a maturing library and is baked into the official release of MVC 4 onwards. For now, the following screencasts should help you become quite familiar with using Web API in MVC 4. For detailed information on how to do this, see <a href="http://weblogs.asp.net/jgalloway/archive/2012/03/16/asp-net-web-api-screencast-series-with-downloadable-sample-code-part-1.aspx">Web API With MVC 4 Screencast Series</a>.</p>

<p>The complete application used in this project is available on the <a href="https://github.com/telerik/html5-dev-for-aspnet-devs">GitHub site course</a>.</p>

<h2 id="see-also"><a href="#see-also">See Also</a></h2>

<p>Tutorials on how to build an HTML application in ASP.NET:</p>

<ul>
<li><a href="/docs-kendo-china/third-party/tutorials/webforms/asp-net-hello-jquery">Part 1 - Hello jQuery</a></li>
<li><a href="/docs-kendo-china/third-party/tutorials/webforms/asp-net-hello-html5">Part 3 - Hello HTML5</a></li>
<li><a href="/docs-kendo-china/third-party/tutorials/webforms/asp-net-hello-kendo-ui-part-1">Part 4 - Hello Kendo UI</a></li>
<li><a href="/docs-kendo-china/third-party/tutorials/webforms/asp-net-hello-kendo-ui-part-2">Part 5 - Hello Kendo UI Grid CRUD Operations</a></li>
</ul> 
        </article>
    </div>
    <div id="feedback-container">
  <div id="feedback-section">
    <script src="/docs-kendo-china/assets/feedback.js?cb=e99a3802c754fe2425831d58312c7c8b"></script>
    <span id="popupNotification"></span>
    <div id="feedback-menu-container">
      <div id="helpful-buttons-container">
        <span class="side-title">Is this article helpful?</span>
        <a class="button" id="yesButton">Yes</a> /
        <a class="button" id="noButton">No</a>
      </div>
      <div id="feedback-submitted-container">
        <span class="side-title">Thank you for your feedback!</span>
      </div>
    </div>
    <div id="feedback-window-container">
      <div id="feedback-form-window" style="background-color: white;">
        <h1 class="feedback-extw__title">Give article feedback</h1>
        <p>Tell us how we can improve this article</p>
        <span id="feedback-form-popup-container"></span>
        <form id="feedback-form">
          <div id="feedback-checkbox-area">
            <input id="hidden-sheet-id" type="hidden" value="14zzclhdh7dMLpg0iq4-2hweCdEiuxxqP3tHdr42-_Cs">
            <label>
              <input type="checkbox" data-bind="checked: outdatedSample" /> Code samples are inaccurate / outdated.
            </label>
            <span class="required-field" data-bind="visible: outdatedSample"></span>
            <textarea id="feedback-code-sample-text-input" placeholder="Please, specify more details ..." class="feedback-extw__textarea"
              data-bind="visible: outdatedSample, value: inaccurateOutdatedCodeSamplesText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: otherMoreInformation" /> I expected to find other / more information.
            </label>
            <span class="required-field" data-bind="visible: otherMoreInformation"></span>
            <textarea id="feedback-more-information-text-input" class="feedback-extw__textarea" placeholder="Please, specify what information can be added ..."
              data-bind="visible: otherMoreInformation, value: otherMoreInformationText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: textErrors" /> There are typos / broken links / broken page elements.
            </label>
            <span class="required-field" data-bind="visible: textErrors"></span>
            <textarea id="feedback-text-errors-text-input" class="feedback-extw__textarea" placeholder="Please, specify what needs to be fixed ..."
              data-bind="visible: textErrors, value: typosLinksElementsText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: inaccurateContent" /> Content is inaccurate / outdated.
            </label>
            <span class="required-field" data-bind="visible: inaccurateContent"></span>
            <textarea id="feedback-inaccurate-content-text-input" class="feedback-extw__textarea" placeholder="Please, specify which conent ..."
              data-bind="visible: inaccurateContent, value: inaccurateOutdatedContentText"></textarea>
            <label>
              <input type="checkbox" data-bind="checked: otherFeedback" /> Other
            </label>
            <span class="required-field" data-bind="visible: otherFeedback"></span>
            <textarea id="feedback-other-text-input" placeholder="Please, enter more details or not listed feedback ..." class="feedback-extw__textarea"
              data-bind="visible: otherFeedback, value: textFeedback">
          </textarea>
            <input id="feedback-email-input" type="email" placeholder="email (optional)" data-email-msg="Email format is not valid."
              class="feedback-extw__input input" data-bind="value: email" />
          </div>
        </form>
        <div class="feedback-extw__foot">
          <button id="form-submit-button" class="feedback-extw__button button button--action">Send feedback</button>
          <button id="form-close-button" class="feedback-extw__button button">Cancel</button>
        </div>
      </div>
    </div>
    <a id="close-button" class="button">
      <img src="/docs-kendo-china/images/close-btn.svg" alt="close" />
    </a>
  </div>
  <div id="feedback-section-dummy">Dummy</div>
</div>
    <footer>
    <p>Copyright &copy; 2017 Progress Software Corporation and/or its subsidiaries or affiliates. All Rights Reserved.</p>
</footer>

</div>
    </body>
</html>

