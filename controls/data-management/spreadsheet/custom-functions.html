<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <meta name="restype" content="documentation">
        <meta name="product" content="kendo-ui">
        <meta name="subproduct" content="spreadsheet">
        <title>Custom Functions | Kendo UI Spreadsheet</title>
        <link rel="shortcut icon" href="/docs-kendo-china/favicon.ico"/>
        <meta name="description" content="Learn how to make your own JavaScript functions in the Kendo UI Spreadsheet widget.">
        <link href="//fonts.googleapis.com/css?family=Roboto:400,500,700,900" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700' rel='stylesheet' type='text/css'>
        <!-- <link href="https://kendo.cdn.telerik.com/2017.3.1026/styles/kendo.common.min.css" rel="stylesheet" /> -->
        <link rel="stylesheet" href="http://oygy5legq.bkt.clouddn.com/kendo.common.min.css">
        <link rel="stylesheet" href="/docs-kendo-china/assets/styles.css?cb=8338967476da1c756a6defe19c1f9984">
        <link rel="stylesheet" href="/docs-kendo-china/assets/icon-font.css?cb=25d8b9593057297c278fcd6d7d263c8e">
        <link rel="stylesheet" href="/docs-kendo-china/assets/theme.css?cb=d82da02940126146560da1ae3bb0bf64">
        
        <!-- <script src="https://code.jquery.com/jquery-1.10.2.js"></script> -->
        <script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
        <!-- <script src="https://kendo.cdn.telerik.com/2017.3.1026/js/kendo.web.min.js"></script> -->
        <script src="http://oygy5legq.bkt.clouddn.com/kendo.web.min.js"></script>
        <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/javascript/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/css/css.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/xml/xml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/htmlmixed/htmlmixed.min.js"></script> -->
        <script src="/docs-kendo-china/assets/prettify.js?cb=9671553084e1962263b152af1f563c3c"></script>
        <script src="/docs-kendo-china/assets/app.js?cb=b449339ba367b10f8b479f2e4faac62b"></script>
        
        

        <!--[if lt IE 9]>
        <script>
        document.createElement('header');
        document.createElement('nav');
        document.createElement('section');
        document.createElement('article');
        document.createElement('aside');
        document.createElement('footer');
        document.createElement('hgroup');
        </script>
        <![endif]-->
    </head>
    <body>
        <!-- Google Tag Manager -->
        <!-- <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script> -->
        <!-- End Google Tag Manager -->
        <aside class="TK-Hat">
    <figure class="TK-Hat-Brand">
        <a href="https://www.progress.com" class="TK-PRGS-Logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="94" height="40" viewBox="0 0 512 120">
                <path fill="#5ce500" d="M95.52 29.33v51a3.93 3.93 0 0 1-1.78 3.08l-1.67 1-12.72 7.35-8.59 5-1.78 1V42.6L21.23 15 43.91 1.93 46 .74a3.94 3.94 0 0 1 3.56 0L81 18.9l14.51 8.38v2.05zM58.36 48.72l-9.79-5.66-22.91-13.23a4 4 0 0 0-3.56 0L1.77 41.57 0 42.6l34.49 19.91v39.83l20.3-11.73 1.79-1a3.94 3.94 0 0 0 1.78-3.08V48.72zM0 82.43l23.86 13.78V68.63z"></path>
                <path fill="#4b4e52" d="M148.09 27.28h-26v70.48h11.55V70.1h14.57c15.77 0 24.45-7.7 24.45-21.69 0-6.35-2.4-21.12-24.55-21.12m12.78 21.31c0 7.95-4.12 11.19-14.24 11.19h-13v-22.1h14.57c8.56 0 12.71 3.57 12.71 10.91M207 46.41l.87.42-2 10.42-1.35-.42a11.32 11.32 0 0 0-3.34-.51c-10.79 0-11.67 8.59-11.67 19v22.44h-10.64V46h10v6.24c2.73-4.2 6-6.37 10.37-6.9a14.55 14.55 0 0 1 7.76 1.07M233.29 45c-8.42 0-15.16 3.2-19.5 9.27-4.56 6.37-5.23 13.85-5.23 17.74 0 16.36 9.7 26.92 24.73 26.92 18.26 0 24.73-14.71 24.73-27.3 0-7.25-2.15-13.82-6-18.51-4.41-5.31-10.87-8.12-18.7-8.12m0 44.38c-8.37 0-13.57-6.66-13.57-17.37s5.2-17.55 13.57-17.55S247 61.23 247 71.78c0 10.83-5.24 17.56-13.66 17.56m114.55-42.93l.87.42-2 10.42-1.35-.42a11.26 11.26 0 0 0-3.33-.51c-10.78 0-11.66 8.59-11.66 19v22.44h-10.66V46h10v6.24c2.73-4.2 6-6.37 10.37-6.9a14.54 14.54 0 0 1 7.73 1.06m38.4 34.76l-.2.57c-2.23 6.36-7.57 7.7-11.65 7.7-8.09 0-13.3-5.37-13.81-14.09h36.59l.13-1a31.26 31.26 0 0 0 .12-4.12v-.93C396.93 54.78 387.48 45 374 45c-7.9 0-14.37 3.1-18.73 9a30.85 30.85 0 0 0-5.54 18c0 16 9.95 26.74 24.74 26.74 11.45 0 19.33-5.82 22.2-16.38l.33-1.2h-10.7zM361 66.05c.9-7.17 5.81-11.73 12.79-11.73 5.33 0 11.64 3.1 12.52 11.73H361zm-60.7-15.71c-3.45-3.58-8.06-5.39-13.76-5.39-15.69 0-22.83 13.81-22.83 26.63 0 13.16 7.06 26.44 22.83 26.44a18.33 18.33 0 0 0 13.35-5.42c0 2.28-.1 4.45-.16 5.38-.58 8.54-4.68 12.51-12.91 12.51-4.47 0-9.61-1.59-10.6-6l-.22-1h-10.54l.17 1.41c1.1 9.12 9.11 14.79 20.9 14.79 10.34 0 17.7-3.9 21.28-11.26 1.73-3.55 2.6-8.72 2.6-15.37V46h-10.13v4.34zm-13.11 38.15c-3.74 0-12.43-1.69-12.43-17.37 0-10.3 4.87-16.7 12.71-16.7 6.06 0 12.52 4.39 12.52 16.7 0 10.87-4.79 17.37-12.81 17.37m159.67-6.31c0 8.23-6.83 16.53-22.09 16.53-13.5 0-21.53-5.85-22.61-16.45l-.15-1.1h10.52l.21.84c1.29 6.38 7.37 7.72 12.24 7.72 5.34 0 11-1.72 11-6.54 0-2.44-1.59-4.18-4.73-5.16-1.86-.55-4.15-1.2-6.56-1.87-4.16-1.16-8.47-2.38-11.12-3.29-6.56-2.35-10.33-6.93-10.33-12.56 0-10.43 10.16-15.11 20.22-15.11 13.46 0 20.42 5.07 21.3 15.49l.09 1.07H434.5l-.14-.82c-1-6-7-6.9-10.48-6.9-3 0-10 .53-10 5.5 0 2.25 1.93 3.91 5.89 5.06 1.18.33 2.94.78 5 1.31 4.22 1.09 9.48 2.46 12.13 3.37 6.59 2.32 9.93 6.67 9.93 13m49.39 0c0 8.23-6.83 16.53-22.09 16.53-13.5 0-21.53-5.85-22.61-16.45l-.11-1.09H462l.12.74c1.29 6.38 7.37 7.72 12.24 7.72 5.34 0 11-1.72 11-6.54 0-2.44-1.59-4.18-4.72-5.16-1.86-.55-4.15-1.2-6.57-1.87-4.16-1.16-8.46-2.38-11.11-3.29-6.57-2.35-10.33-6.93-10.33-12.56 0-10.43 10.16-15.11 20.22-15.11 13.46 0 20.42 5.07 21.29 15.49l.09 1.07H483.9l-.14-.82c-1-6-7-6.9-10.48-6.9-3 0-9.95.53-9.95 5.5 0 2.25 1.93 3.91 5.89 5.06 1.18.33 2.94.78 5 1.31 4.22 1.09 9.48 2.46 12.13 3.37 6.58 2.32 9.93 6.67 9.93 13m8.43-30.78a7.37 7.37 0 1 1 7.29-7.37 7.23 7.23 0 0 1-7.29 7.37m0-13.49a6.12 6.12 0 1 0 6 6.12 5.91 5.91 0 0 0-6-6.12m-.85 7.49v2.46h-2.17v-7.74h3.62a2.58 2.58 0 0 1 2.86 2.7 2.26 2.26 0 0 1-1.49 2.34l1.77 2.7H506l-1.49-2.46h-.68zm1.21-3.49h-1.21v1.73h1.21a.86.86 0 0 0 1-.85.88.88 0 0 0-1-.89"></path>
            </svg>
        </a>
    </figure>
</aside>
<header id="page-header">
    <div class="toggle-nav"><span class="k-icon k-i-menu"></span></div>


    <div id="logo-bar">
        <a href="/docs-kendo-china/introduction">
            <img alt="Kendo UI logo" class="logo" src="/docs-kendo-china/images/kendo-ui.svg">
        </a>
    </div>

    
    <span class="show-search">
        <span class="k-icon k-i-search"></span>
    </span>
    
    <div class="nav-buttons">
        <a href="http://demos.telerik.com/kendo-ui/" class="btn demos-btn">Demos</a>
        <a href="http://www.telerik.com/kendo-ui" class="btn about-btn">About</a>
        <a href="http://www.telerik.com/purchase/kendo-ui" class="btn pricing-btn">Pricing</a>
        <a href="http://www.telerik.com/download/kendo-ui" class="btn btn-primary">Try now</a>
    </div>
</header>
        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
        $("#page-tree").kendoTreeView({
            dataSource: {
                transport: {
                    read: {
                        url: "/docs-kendo-china/default.json",
                        dataType: "json"
                    }
                },
                schema: {
                    model: {
                        id: "path",
                        children: "items",
                        hasChildren: "items"
                    }
                }
            },
            messages: {
                loading: " "
            },
            select: preventParentSelection,
            template: navigationTemplate("/docs-kendo-china/"),
            dataBound: expandNavigation("controls/data-management/spreadsheet/custom-functions.html")
        });
        </script>
    </div>

    <a id="page-edit-link" href="https://github.com/telerik/kendo-ui-core/edit/master/docs//controls/data-management/spreadsheet/custom-functions.md"><span class="k-icon k-i-pencil"></span> Edit this page</a>
    

    <div id="page-article">
        <article>
            
             <h1 id="custom-functions"><a href="#custom-functions">Custom Functions</a></h1>

<p>In formulas, you can create your own custom JavaScript functions (primitives) by calling the <code>kendo.spreadsheet.defineFunction(name, func)</code>.</p>

<p>The first argument (string) is the name for your function in formulas (case-insensitive), and the second one is a JavaScript function (the implementation).</p>

<h2 id="primitives"><a href="#primitives">Primitives</a></h2>

<h3 id="synchronous-primitives"><a href="#synchronous-primitives">Synchronous Primitives</a></h3>

<p>The following example demonstrates how to define a function that calculates the distance between two points.</p>

<h6>Example</h6>

<pre><code>kendo.spreadsheet.defineFunction("distance", function(x1, y1, x2, y2){
    var dx = Math.abs(x1 - x2);
    var dy = Math.abs(y1 - y2);
    var dist = Math.sqrt(dx*dx + dy*dy);
    return dist;
}).args([
    [ "x1", "number" ],
    [ "y1", "number" ],
    [ "x2", "number" ],
    [ "y2", "number" ]
]);
</code></pre>

<p>If you include the above JavaScript code, you can then use <code>DISTANCE</code> in formulas. For example, to find the distance between coordinate points <code>(2,2)</code> and <code>(5,6)</code>, type in a cell <code>=DISTANCE(2, 2, 5, 6)</code>. Optionally, you can use the function in combined expressions such as <code>=DISTANCE(0, 0, 1, 1) + DISTANCE(2, 2, 5, 6)</code>.</p>

<p>In the above example, <code>defineFunction</code> returns an object that has an <code>args</code> method. You can use it to specify the expected types of arguments. If the function is called with mismatching argument types, the runtime of the Spreadsheet automatically returns an error and your implementation is not called. This spares the time for manually writing code that does argument type checking and provides a nice declarative syntax instead.</p>

<h3 id="asynchronous-primitives"><a href="#asynchronous-primitives">Asynchronous Primitives</a></h3>

<p>To retrieve currency information from a remote server, define a primitive to make this information available in formulas. To define an asynchronous function, call <code>argsAsync</code> instead of <code>args</code>.</p>

<h6>Example</h6>

<pre><code>kendo.spreadsheet.defineFunction("currency", function(callback, base, curr){
    // let's say we have this fetchCurrency function;
    // how it's implemented is not relevant for the goal of this document
    fetchCurrency(base, curr, function(value){
        callback(value);
    });
}).argsAsync([
    [ "base", "string" ],
    [ "curr", "string" ]
]);
</code></pre>

<blockquote>
<p><strong>Important</strong></p>

<p>The <code>argsAsync</code> passes a callback as the first argument to your implementation function, which you need to call with the return value.</p>
</blockquote>

<p>It is possible to use new approaches in formulas such as <code>=CURRENCY("EUR", "USD")</code> and <code>=A1 * CURRENCY("EUR", "USD")</code>. Note that the callback is invisible in formulas. The second formula shows that even though the implementation itself is asynchronous, it can be used in formulas in a synchronous way—that is, the result yielded by <code>CURRENCY</code> is multiplied by the value in <strong>A1</strong>.</p>

<p>The rest of this article provides information on argument types.</p>

<h2 id="checking-argument-types"><a href="#checking-argument-types">Checking Argument Types</a></h2>

<p>As can be seen in the examples above, both <code>args</code> and <code>argsAsync</code> expect a single array argument. It contains one definition for each argument. Each definition is in turn an array where the first element is the argument name that has to be a valid JavaScript identifier and the second element is a type specifier.</p>

<h3 id="basic-type-specifiers"><a href="#basic-type-specifiers">Basic Type Specifiers</a></h3>

<p>As of now, the following basic specifiers are supported:</p>

<table>
<thead>
<tr>
<th align="left">BASIC SPECIFIER</th>
<th align="left">ACTION</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>"number"</code></td>
<td align="left">Requires a numeric argument.</td>
</tr>
<tr>
<td align="left"><code>"number+"</code></td>
<td align="left">Requires a number bigger than or equal to zero.</td>
</tr>
<tr>
<td align="left"><code>"number++"</code></td>
<td align="left">Requires a non-zero positive number.</td>
</tr>
<tr>
<td align="left">
<code>"integer"</code>/<code>"integer+"</code>/<code>"integer++"</code>
</td>
<td align="left">Similar to <code>number</code>-s, but requires integer argument. Note that these may actually modify the argument value: if a number is specified and it has a decimal part, it will silently be truncated to integer, instead of returning an error. This is similar to Excel.</td>
</tr>
<tr>
<td align="left"><code>"divisor"</code></td>
<td align="left">Requires a non-zero number. Produces a <code>#DIV/0!</code> error if the argument is zero.</td>
</tr>
<tr>
<td align="left"><code>"string"</code></td>
<td align="left">Requires a string argument.</td>
</tr>
<tr>
<td align="left"><code>"boolean"</code></td>
<td align="left">Requires a boolean argument. Most times you may want to use <code>"logical"</code> though.</td>
</tr>
<tr>
<td align="left"><code>"logical"</code></td>
<td align="left">Requires a <code>logical</code> argument. That is, Booleans <code>true</code> or <code>false</code>, but <code>1</code> and <code>0</code> are also accepted. It gets converted to an actual Boolean.</td>
</tr>
<tr>
<td align="left"><code>"date"</code></td>
<td align="left">Requires a date argument. Internally, dates are stored as numbers (the number of days since December 31 1899), so this works the same as <code>"integer"</code>. It was added for consistency.</td>
</tr>
<tr>
<td align="left"><code>"datetime"</code></td>
<td align="left">This is like <code>"number"</code>, because the time part is represented as a fraction of a day.</td>
</tr>
<tr>
<td align="left"><code>"anyvalue"</code></td>
<td align="left">Accepts any value type.</td>
</tr>
<tr>
<td align="left"><code>"matrix"</code></td>
<td align="left">Accepts a matrix argument. This is either a range, for example, <code>A1:C3</code>, or a literal matrix (see the <strong>Matrices</strong> section below).</td>
</tr>
<tr>
<td align="left"><code>"null"</code></td>
<td align="left">Requires a null (missing) argument. The reason for this specifier will be clarified in the <strong>Optional Arguments</strong> section.</td>
</tr>
</tbody>
</table>

<p>Again, to make it clear, some specifiers actually modify the value that your function receives. For example, you could implement a function that truncates the argument to integer, as shown below.</p>

<h6>Example</h6>

<pre><code>defineFunction("truncate", function(value){
    return value;
}).args([
    [ "value", "integer" ]
]);
</code></pre>

<p>If you call <code>=TRUNCATE(12.634)</code>, the result is <code>12</code>. You can also call <code>=TRUNCATE(TRUE)</code>, it returns <code>1</code>. All numeric types silently accept a Boolean, and convert <code>true</code> to <code>1</code> and <code>false</code> to <code>0</code>.</p>

<h3 id="getting-error-values"><a href="#getting-error-values">Getting Error Values</a></h3>

<p>By default, if an argument is an error, your function is not called and that error is returned.  </p>

<h6>Example</h6>

<pre><code>defineFunction("iserror", function(value){
    return value instanceof kendo.spreadsheet.CalcError;
}).args([
    [ "value", "anyvalue" ]
]);
</code></pre>

<p>With this implementation, when you type <code>=ISERROR(1/0)</code>, <code>#DIV/0!</code> instead of <code>true</code> is returned—the error is passed over and aborts the computation. To allow the passing of errors, append a <code>!</code> to the type.</p>

<h6>Example</h6>

<pre><code>...args([
    [ "value", "anyvalue!" ]
]);
</code></pre>

<p>The result is that <code>true</code> is returned.</p>

<h3 id="reference-type-specifiers"><a href="#reference-type-specifiers">Reference Type Specifiers</a></h3>

<p>All above-mentioned type specifiers force references. FBecasues of this, <code>=TRUNCATE(A5)</code> also works. The function gets the value in the <code>A5</code> cell. If <code>A5</code> contains a formula, the runtime library verifies you get the current value—that is, <code>A5</code> is evaluated first. All of this goes under the hood and you need not worry about it.</p>

<p>Sometimes you might need to write functions that receive a reference instead of a resolved value. Such an example is the <code>ROW</code> function of Excel. In its basic form, it takes a cell reference and returns its row number, as demonstrated in the following example. The actual <code>ROW</code> function is more complicated.</p>

<h6>Example</h6>

<pre><code>defineFunction("row", function(cell){
    // add 1 because internally row indexes are zero-based
    return cell.row + 1;
}).args([
    [ "reference", "cell" ]
]);
</code></pre>

<p>If you now call <code>=ROW(A5)</code>, you get <code>5</code> as a result, regardless of the content in the <code>A5</code> cell—it might be empty or it is possible that this very formula sits in the <code>A5</code> cell and there must be no circular reference error in such a case.</p>

<p>See the <strong>References</strong> section below for more information about references.</p>

<p>The following table lists the related type specifiers:</p>

<table>
<thead>
<tr>
<th align="left">TYPE SPECIFIER</th>
<th align="left">ACTION</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>"ref"</code></td>
<td align="left">Allows any reference argument and your implementation gets it as such.</td>
</tr>
<tr>
<td align="left"><code>"area"</code></td>
<td align="left">Allows a cell or a range argument (<code>CellRef</code> or <code>RangeRef</code> instance).</td>
</tr>
<tr>
<td align="left"><code>"cell"</code></td>
<td align="left">Allows a cell argument (<code>CellRef</code> instance).</td>
</tr>
<tr>
<td align="left"><code>"anything"</code></td>
<td align="left">Allows any argument type. The difference to <code>anyvalue</code> is that this one does not force references—that is, if a reference is passed, it remains a reference instead of being replaced by its value.</td>
</tr>
</tbody>
</table>

<h3 id="compound-type-specifiers"><a href="#compound-type-specifiers">Compound Type Specifiers</a></h3>

<p>In addition to the basic type specifiers that are strings, you can also use the following forms of type specifications:</p>

<table>
<thead>
<tr>
<th align="left">ADDITIONAL SPECIFIER</th>
<th align="left">ACTION</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>[ "null", DEFAULT ]</code></td>
<td align="left">Validates a missing argument and makes it take the given <code>DEFAULT</code> value. This can be used in conjunction with <code>"or"</code> to support optional arguments.</td>
</tr>
<tr>
<td align="left"><code>[ "not", SPEC ]</code></td>
<td align="left">Requires an argument which does not match the specification.</td>
</tr>
<tr>
<td align="left"><code>[ "or", SPEC, SPEC, ... ]</code></td>
<td align="left">Validates an argument that passes any of the specifications.</td>
</tr>
<tr>
<td align="left"><code>[ "and", SPEC, SPEC, ... ]</code></td>
<td align="left">Validates an argument that passes all the specifications.</td>
</tr>
<tr>
<td align="left"><code>[ "values", VAL1, VAL2, ... ]</code></td>
<td align="left">The argument must strictly equal one of the listed values.</td>
</tr>
<tr>
<td align="left"><code>[ "[between]", MIN, MAX ]</code></td>
<td align="left">Validates an argument between the given values inclusive. Note that it does not require numeric argument. The "between" value is an alias.</td>
</tr>
<tr>
<td align="left"><code>[ "(between)", MIN, MAX ]</code></td>
<td align="left">This is similar to "[between]" but is exclusive.</td>
</tr>
<tr>
<td align="left"><code>[ "[between)", MIN, MAX ]</code></td>
<td align="left">Requires an argument greater than or equal to <code>MIN</code>, and strictly less than <code>MAX</code>.</td>
</tr>
<tr>
<td align="left"><code>[ "(between]", MIN, MAX ]</code></td>
<td align="left">Requires an argument strictly greater than <code>MIN</code>, and less than or equal to <code>MAX</code>.</td>
</tr>
<tr>
<td align="left"><code>[ "assert", COND ]</code></td>
<td align="left">Inserts an arbitrary condition literally into the code (see the <strong>Assertions</strong> section below).</td>
</tr>
<tr>
<td align="left"><code>[ "collect", SPEC ]</code></td>
<td align="left">Collects all remaining arguments that pass the specification into a single array argument. This only makes sense at top level and cannot be nested in <code>"or"</code>, <code>"and"</code>, etc. Arguments not matching the <code>SPEC</code> are silently ignored, except errors. Each error aborts the calculation.</td>
</tr>
<tr>
<td align="left"><code>[ "#collect", SPEC ]</code></td>
<td align="left">This is similar to "collect", but ignores errors as well.</td>
</tr>
</tbody>
</table>

<h3 id="previous-arguments-reference"><a href="#previous-arguments-reference">Previous Arguments Reference</a></h3>

<p>In certain clauses you might need to refer to values of previously type-checked arguments. For example, if you want to write a primitive that takes a minimum, a maximum, and a value that must be between them, and should return as a fraction the position of that value between min and max.</p>

<h6>Example</h6>

<pre><code>defineFunction("my.position", function(min, max, value){
    return (value - min) / (max - min);
}).args([
    [ "min", "number" ],
    [ "max", "number" ],
    [ "value", [ "and", "number",
                 [ "[between]", "$min", "$max" ] ] ]
]);
</code></pre>

<p>Note the type specifier for <code>"value"</code>:</p>

<pre><code>[ "and", "number",
  [ "[between]", "$min", "$max" ] ]
</code></pre>

<p>The code requires that the parameter is a number and that it has to be between <code>min</code> and <code>max</code>. To refer to a previous argument, prefix the identifier with a <code>$</code> character. This approach works for arguments of <code>"between"</code> (and friends), <code>"assert"</code>, <code>"values"</code> and <code>"null"</code>.</p>

<h3 id="arbitrary-assertions"><a href="#arbitrary-assertions">Arbitrary Assertions</a></h3>

<p>The above function is not quite correct because it does not check that <code>max</code> is actually greater than <code>min</code>. To do that, use <code>"assert"</code>, as demonstrated in the following example.</p>

<pre><code>defineFunction("my.position", function(min, max, value){
    return (value - min) / (max - min);
}).args([
    [ "min", "number" ],
    [ "max", "number" ],
    [ "value", [ "and", "number",
                 [ "[between]", "$min", "$max" ] ] ],
    [ "?", [ "assert", "$min &lt; $max", "N/A" ] ]
]);
</code></pre>

<p>The <code>"assert"</code> type specification allows you to introduce an arbitrary condition into the JavaScript code of the type-checking function. An argument name of <code>"?"</code> does not actually introduce a new argument, but provides a place for such assertions. The third argument to <code>"assert"</code> is the error code that it should produce if the condition does not stand (and <code>#N/A!</code> is actually the default).</p>

<h3 id="optional-arguments"><a href="#optional-arguments">Optional Arguments</a></h3>

<p>As hinted above, you can use the <code>"null"</code> specifier to support optional arguments.</p>

<p>The following example demonstrates the actual definition of the <code>ROW</code> function.</p>

<pre><code>defineFunction("row", function(ref){
    if (!ref) {
        return this.formula.row + 1;
    }
    if (ref instanceof CellRef) {
        return ref.row + 1;
    }
    return this.asMatrix(ref).mapRow(function(row){
        return row + ref.topLeft.row + 1;
    });
}).args([
    [ "ref", [ "or", "area", "null" ]]
]);
</code></pre>

<p>The code requires that the argument can either be an area (a cell or a range) or <code>null</code> (that is, missing). By using the <code>"or"</code> combiner, you make it accept either of these. If the argument is missing, your function gets <code>null</code>. In such cases, it has to return the row of the current formula that you get by <code>this.formula.row</code>. For more details, refer to the <a href="#context-objects">section on context objects</a>.</p>

<p>In most cases, “optional” means that the argument takes some default value if one is not provided. For example, the <code>LOG</code> function computes the logarithm of the argument to a base, but if the base is not specified, it defaults to 10.</p>

<p>The following example demonstrates this implementation.</p>

<pre><code>defineFunction("log", function(num, base){
    return Math.log(num) / Math.log(base);
}).args([
    [ "*num", "number++" ],
    [ "*base", [ "or", "number++", [ "null", 10 ] ] ],
    [ "?", [ "assert", "$base != 1", "DIV/0" ] ]
]);
</code></pre>

<!--*-->

<p>The type specification for <code>base</code> is: <code>[ "or", "number++", [ "null", 10 ] ]</code>. This says it should accept any number greater than zero, but if the argument is missing, defaults to 10. The implementation does not have to deal with the case that the argument is missing — it will get 10 instead. Note that it uses an assertion to make sure the <code>base</code> is not 1. If the <code>base</code> is 1, a <code>#DIV/0!</code> error is returned.</p>

<h3 id="return-errors"><a href="#return-errors">Return Errors</a></h3>

<p>To return an error code, return a <code>spreadsheet.CalcError</code> object.</p>

<h6>Example</h6>

<pre><code>defineFunction("tan", function(x){
    // if x is sufficiently close to PI, tan would return
    // Infinity, or some really big number; let's error out instead
    if (Math.abs(x - Math.PI/2) &lt; 1e-10) {
        return new spreadsheet.CalcError("DIV/0");
    }
    return Math.tan(x);
}).args([
    [ "x", "number" ]
]);
</code></pre>

<blockquote>
<p><strong>Important</strong></p>

<p>For convenience, you can also <code>throw</code> a <code>CalcError</code> object for synchronous primitives—that is, if you use <code>args</code> and not <code>argsAsync</code>.</p>
</blockquote>

<p>Note that it is possible to do the above through an assertion as well, as demonstrated in the following example.</p>

<pre><code>defineFunction("tan", function(x){
    return Math.tan(x);
}).args([
    [ "x", [ "and", "number",
             [ "assert", "1e-10 &lt; Math.abs($x - Math.PI/2)", "DIV/0" ] ] ]
]);
</code></pre>

<h3 id="variable-argument-list"><a href="#variable-argument-list">Variable Argument List</a></h3>

<p>The type checking mechanism errors out when your primitive receives more arguments than specified. There are a few ways to receive all remaining arguments without errors.</p>

<h4>The <code>"rest"</code> Type Specifier</h4>

<p>The simplest way is to use the <code>"rest"</code> type specifier. In such cases, the last argument is an array that contains all remaining arguments, whatever types they might be.</p>

<p>The following example demonstrates how to use a function that joins arguments with a separator producing a string.</p>

<h6>Example</h6>

<pre><code>defineFunction("join", function(sep, list){
    return list.join(sep);
}).args([
    [ "sep", "string" ],
    [ "list", "rest" ]
]);
</code></pre>

<p>This allows for <code>=JOIN("-", 1, 2, 3)</code> which returns <code>1-2-3</code> and for <code>=JOIN(".")</code> which returns the empty string because the list will be empty.</p>

<h4>The <code>"collect"</code> Clauses</h4>

<p>The <code>"collect"</code> clauses collect all remaining arguments that match a certain type specifier, ignoring all others except for the errors. You can use them in functions like <code>SUM</code> that sums all numeric arguments, but does not care about empty or text arguments.</p>

<p>The following example demonstrates the definition of <code>SUM</code>.</p>

<pre><code>defineFunction("sum", function(numbers){
    return numbers.reduce(function(sum, num){
        return sum + num;
    }, 0);
}).args([
    [ "numbers", [ "collect", "number" ] ]
]);
</code></pre>

<p>The <code>"collect"</code> clause aborts when it encounters an error. To ignore errors as well, use the <code>"#collect"</code> specification. Note that <code>"collect"</code> and <code>"#collect"</code> only make sense when either is the first specifier—that is, they cannot be nested in <code>"or"</code>, <code>"and"</code>, and the like.</p>

<h4>Other Type-Checked Arguments</h4>

<p>There are functions that allow an arbitrary number of arguments of specific types. For example, the <code>SUMPRODUCT</code> function takes an arbitrary number of arrays, multiplies the corresponding numbers in these arrays, and then returns the sum of the products. In this case, you need at least two arrays.</p>

<p>The following example demonstrates the argument specification.</p>

<pre><code>[
    [ "a1", "matrix" ],
    [ "+",
      [ "a2", [ "and", "matrix",
                [ "assert", "$a2.width == $a1.width" ],
                [ "assert", "$a2.height == $a1.height" ] ] ] ]
]
</code></pre>

<p>The <code>"+"</code> in the second definition means that one or more arguments are expected to follow and that the <code>a2</code> argument, defined there, can repeat. Notice how you can use assertions to make sure the matrices have the same shape as the first one (<code>a1</code>).</p>

<p>For another example, look at the <code>SUMIFS</code> function (<a href="https://support.office.com/en-us/article/SUMIFS-function-c9e748f5-7ea7-455d-9406-611cebce642b">see Excel documentation</a>). It takes a <code>sum_range</code>, a <code>criteria_range</code>, and a <code>criteria</code>. These are the required arguments. Then, any number of <code>criteria_range</code> and <code>criteria</code> arguments can follow. In particular, criteria ranges must all have the same shape (width/height). Here is the argument definition for <code>SUMIFS</code>:</p>

<pre><code>[
    [ "range", "matrix" ],
    [ "m1", "matrix" ],
    [ "c1", "anyvalue" ],
    [ [ "m2", [ "and", "matrix",
                [ "assert", "$m1.width == $m2.width" ],
                [ "assert", "$m1.height == $m2.height" ] ] ],
      [ "c2", "anyvalue" ] ]
]
</code></pre>

<p>The repeating part now is simply enclosed in an array, not preceded by <code>"+"</code>. This indicates to the system that any number might follow, including zero, while <code>"+"</code> requires at least one argument.</p>

<h2 id="date-and-time-representation"><a href="#date-and-time-representation">Date and Time Representation</a></h2>

<p>Dates are stored as the number of days since 1899-12-31 that is considered to be the first date. In Excel, the first day is 1900-01-01, but for historical reasons Excel assumes that 1900 is a leap year. For more information, refer to the article on the <a href="https://en.wikipedia.org/wiki/Leap_year_bug">leap year bug</a>. In Excel, day 60 yields an invalid date (1900-02-29), which means that date calculations involving dates before and after 1900-03-01 produce wrong results.</p>

<p>To be compatible with Excel and to avoid the unwilling implementation of this bug, the Spreadsheet uses 1899-12-31 as the base date. Dates that are greater than or equal to 1900-03-31 have the same numeric representation as in Excel, while dates before 1900-03-31 are smaller by 1.</p>

<p>Time is kept as a fraction of a day—that is, 0.5 means 12:00:00. For example, the date and time <code>Sep 27 1983 12:35:59</code> is numerically stored as <code>30586.524988425925</code>. To verify that in Excel, paste this number in a cell and then format it as a date or time.</p>

<p>Functions to pack or unpack dates are available in <code>spreadsheet.calc.runtime</code>.</p>

<h6>Example</h6>

<pre><code>var runtime = kendo.spreadsheet.calc.runtime;

// unpacking
var date = runtime.unpackDate(28922.55);
console.log(date); // { year: 1979, month: 2, date: 8, day: 4 }

var time = runtime.unpackTime(28922.55);
console.log(time); // { hours: 13, minutes: 12, seconds: 0, milliseconds: 0 }

var date = runtime.serialToDate(28922.55); // produces JavaScript Date object
console.log(date.toISOString()); // 1979-03-08T13:12:00.000Z

// packing
console.log(runtime.packDate(2015, 5, 25)); // year, month, date
console.log(runtime.packTime(13, 35, 0, 0)); // hours, minutes, seconds, ms
console.log(runtime.dateToSerial(new Date()))
</code></pre>

<p>Note that the serial date representation does not carry any timezone information, so the functions involving <code>Date</code> objects (<code>serialToDate</code> and <code>dateToSerial</code>) use the local components and not UTC—as Excel does.</p>

<h2 id="references"><a href="#references">References</a></h2>

<p>As mentioned earlier, certain type specifiers allow you to get a reference in your function rather than the resolved value. Note that when you do so, you cannot rely on the values in those cells to be calculated. As a result, if your function might need the values as well, you have to compute them. Because the function which does this is asynchronous, your primitive has to be defined in an asynchronous style as well.</p>

<h6>Example</h6>

<pre><code>defineFunction("test", function(callback, x){
    this.resolveCells([ x ], function(){
        console.log(x instanceof spreadsheet.CellRef); // true
        console.log("So we have a cell:");
        console.log(x.sheet, x.row, x.col);
        console.log("And its value is:");
        console.log(this.getRefData(x));
        callback("Cell value: " + this.getRefData(x));
    });
}).argsAsync([
    [ "x", "cell" ]
]);
</code></pre>

<p>This function accepts a cell argument and you can only call it like <code>=test(B4)</code>. It calls <code>this.resolveCells</code> from the context object to verify that the cell value is calculated. Without this step and if the cell actually contains a formula, the value returned by <code>this.getRefData</code> could be outdated. Then it prints some information about that cell.</p>

<p>The following list explains the types of references that your primitive can receive:</p>

<ul>
<li>
<code>spreadsheet.Ref</code>—A base class only. All references inherit from it, but no direct instance of this object should ever be created. The class is exported just to make it easier to check whether something is a reference: <code>x instanceof spreadsheet.Ref</code>.</li>
<li>
<code>spreadsheet.NULLREF</code>—An object (a singleton) and not a class. It represents the <code>NULL</code> reference, and could occur, for example, when you intersect two disjoint ranges, or when a formula depends on a cell that has been deleted. For example, when you put in some cell <code>=test(B5)</code> and then right-click on column <code>B</code> and delete it. To test when something is the <code>NULL</code> reference, just do <code>x === spreadsheet.NULLREF</code>.</li>
<li>
<code>spreadsheet.CellRef</code>—Represents a cell reference. Note that the references here follow the same programming language concept. They do not contain data. Instead they just point to where the data is. So a cell reference contains 3 essential properties:

<ul>
<li>
<code>sheet</code> — the name of the sheet that this cell points to (as a string)</li>
<li>
<code>row</code> — the row number, zero-based</li>
<li>
<code>col</code> — the column number, zero-based</li>
</ul>
</li>
<li>
<code>spreadsheet.RangeRef</code>—A range reference. It contains <code>topLeft</code> and <code>bottomRight</code>, which are <code>CellRef</code> objects.</li>
<li>
<code>spreadsheet.UnionRef</code>—A union. It contains a <code>refs</code> property, which is an array of references (it can be empty). A <code>UnionRef</code> can be created by the union operator, which is the comma.</li>
</ul>

<p>The following example demonstrates how to use a function that takes an arbitrary reference and returns its type of reference.</p>

<h6>Example</h6>

<pre><code>  defineFunction("refkind", function(x){
      if (x === spreadsheet.NULLREF) {
          return "null";
      }
      if (x instanceof spreadsheet.CellRef) {
          return "cell";
      }
      if (x instanceof spreadsheet.RangeRef) {
          return "range";
      }
      if (x instanceof spreadsheet.UnionRef) {
          return "union";
      }
      return "unknown";
  }).args([
      [ "x", "ref" ]
  ]);
</code></pre>

<p>The following example demonstrates how to use a function that takes an arbitrary reference and returns the total number of cells it covers.</p>

<pre><code>  defineFunction("countcells", function(x){
      var count = 0;
      function add(x) {
          if (x instanceof spreadsheet.CellRef) {
              count++;
          } else if (x instanceof spreadsheet.RangeRef) {
              count += x.width() * x.height();
          } else if (x instanceof spreadsheet.UnionRef) {
              x.refs.forEach(add);
          } else {
              // unknown reference type.
              throw new CalcError("REF");
          }
      }
      add(x);
      return count;
  }).args([
      [ "x", "ref" ]
  ]);
</code></pre>

<p>You can now say:</p>

<ul>
<li>
<code>=COUNTCELLS(A1)</code> — returns 1.</li>
<li>
<code>=COUNTCELLS(A1:C3)</code> — returns 9.</li>
<li>
<code>=COUNTCELLS( (A1,A2,A1:C3) )</code> — returns 11. This is a union.</li>
<li>
<code>=COUNTCELLS( (A1:C3 B:B) )</code> — returns 3. This is an intersection between the <code>A1:C3</code> range and the <code>B</code> column.</li>
</ul>

<p>Here is a function that returns the background color of some cell:</p>

<pre><code>  defineFunction("backgroundof", function(cell){
      var workbook = this.workbook();
      var sheet = workbook.sheetByName(cell.sheet);
      return sheet.range(cell).background();
  }).args([
      [ "cell", "cell" ]
  ]);
</code></pre>

<p>It uses <code>this.workbook()</code> to retrieve the workbook, and then uses the Workbook/Sheet/Range APIs to fetch the background color of the given cell.</p>

<h2 id="matrices"><a href="#matrices">Matrices</a></h2>

<p>Matrices are defined by <code>spreadsheet.calc.runtime.Matrix</code>. Your primitive can request a <code>Matrix</code> object by using the <code>"matrix"</code> type specification. In this case, it can accept a cell reference, a range reference, or a literal array. You can type literal arrays in formulas like in Excel, e.g., <code>{ 1, 2; 3, 4 }</code> (rows separated by semicolons).</p>

<p>Matrices were primarily added to deal with the “array formulas” concept in Excel. A function can return multiple values, and those will be in a <code>Matrix</code> object.</p>

<p>The following example demonstrates how to use a function that doubles each number in a range and returns a matrix of the same shape.</p>

<h6>Example</h6>

<pre><code>defineFunction("doublematrix", function(m){
    return m.map(function(value){
        return value * 2;
    });
}).args([
    [ "m", "matrix" ]
]);
</code></pre>

<p>To use this formula:</p>

<ol>
<li>Select a range—for example <code>A1:B2</code>.</li>
<li>Press <code>F12</code> and type <code>=doublematrix(C3:D4)</code>.</li>
<li>Press <code>Ctrl</code>+<code>Shift</code>+<code>Enter</code> (same as in Excel). As a result, cells <code>A1:B2</code> get the doubles of the values from <code>C3:D4</code>.</li>
</ol>

<p>The following table lists some of the methods and properties the <code>Matrix</code> objects provide.</p>

<table>
<thead>
<tr>
<th align="left">METHOD OR PROPERTY</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">
<code>width</code> and <code>height</code>
</td>
<td align="left">These properties indicate the dimensions of this matrix.</td>
</tr>
<tr>
<td align="left"><code>clone()</code></td>
<td align="left">Returns a new matrix with the same data.</td>
</tr>
<tr>
<td align="left"><code>get(row, col)</code></td>
<td align="left">Returns the element at a given location.</td>
</tr>
<tr>
<td align="left"><code>set(row, col, value)</code></td>
<td align="left">Sets the element at a given location.</td>
</tr>
<tr>
<td align="left"><code>each(func, includeEmpty)</code></td>
<td align="left">Iterates through elements of the matrix, calling your <code>func</code> for each element (first columns, then rows) with 3 arguments: <code>value</code>, <code>row</code> and <code>column</code>. If <code>includeEmpty</code> is <code>true</code>, it will call your function for empty (<code>null</code>) elements as well. Otherwise, it only calls it where a value exists.</td>
</tr>
<tr>
<td align="left"><code>map(func, includeEmpty)</code></td>
<td align="left">This is similar to <code>each</code>, but produces a new matrix of the same shape as the original one with the values returned by your functions.</td>
</tr>
<tr>
<td align="left"><code>transpose()</code></td>
<td align="left">Returns the transposed matrix. The rows of the original matrix become columns of the transposed one.</td>
</tr>
<tr>
<td align="left"><code>unit(n)</code></td>
<td align="left">Returns the unit square matrix of size <code>n</code>.</td>
</tr>
<tr>
<td align="left"><code>multiply(m)</code></td>
<td align="left">Multiplies the current matrix by the given matrix, and returns a new matrix as the result.</td>
</tr>
<tr>
<td align="left"><code>determinant()</code></td>
<td align="left">Returns the determinant of this matrix. The matrix should contain only numbers and be square. Note that there are no checks for this.</td>
</tr>
<tr>
<td align="left"><code>inverse()</code></td>
<td align="left">Returns the inverse of this matrix. The matrix should contain only numbers and be square. Note that there are no checks for this. If the inverse does not exist—the determinant is zero—then it returns <code>null</code>.</td>
</tr>
</tbody>
</table>

<h2 id="context-object"><a href="#context-object">Context Object</a></h2>

<p>Every time a formula is evaluated, a special <code>Context</code> object is created and each involved primitive function is invoked in the context of that object—that is, it is accessible as <code>this</code>.</p>

<p>The following table demonstrates some of the methods the <code>Context</code> object provides.</p>

<table>
<thead>
<tr>
<th align="left">METHOD</th>
<th align="left">DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>resolveCells(array, callback)</code></td>
<td align="left">Verifies that all references in the given array are resolved before invoking your callback—that is, executes any formula. If this array turns out to include the cell where the current formula lives, it returns a <code>#CIRCULAR!</code> error. Elements that are not references are ignored.</td>
</tr>
<tr>
<td align="left"><code>cellValues(array)</code></td>
<td align="left">Returns as a flat array the values in any reference that exist in the given array. Elements that are not references are copied over.</td>
</tr>
<tr>
<td align="left"><code>asMatrix(arg)</code></td>
<td align="left">Converts the given argument to a matrix, if possible. It accepts a <code>RangeRef</code> object or a plain JavaScript non-empty array. Additionally, if a <code>Matrix</code> object is provided, it is returned as is.</td>
</tr>
<tr>
<td align="left"><code>workbook()</code></td>
<td align="left">Returns the <code>Workbook</code> object where the current formula is evaluated.</td>
</tr>
<tr>
<td align="left"><code>getRefData(ref)</code></td>
<td align="left">Returns the data—that is the value—in the given reference. If a <code>CellRef</code> is given, it returns a single value. For a <code>RangeRef</code> or <code>UnionRef</code>, it returns a flat array of values.</td>
</tr>
</tbody>
</table>

<p>Additionally, there is a <code>formula</code> property, an object representing the current formula. Its details are internal, but you can rely on it having the <code>sheet</code> (sheet name as a string), <code>row</code> and <code>col</code> properties, the location of the current formula.</p>

<h2 id="not-calling-args-or-argsasync">
<a href="#not-calling-args-or-argsasync">Not Calling </a><code>args</code> or <code>argsAsync</code>
</h2>

<p>This section explains what happens if you do not invoke <code>args</code> or <code>argsAsync</code>. It is recommended that you do not use that form.</p>

<p>If <code>args</code> or <code>argsAsync</code> are not called, the primitive function receives exactly two arguments:</p>

<ul>
<li>A callback to be invoked with the result.</li>
<li>An array that contains the arguments passed in the formula.</li>
</ul>

<p>The following example demonstrates how to use a function that adds two things.</p>

<h6>Example</h6>

<pre><code>defineFunction("add", function(callback, args){
    callback(args[0] + args[1]);
});
</code></pre>

<p>Results:</p>

<ul>
<li>
<code>=ADD(7, 8)</code> → <code>15</code>
</li>
<li>
<code>=ADD()</code> → <code>NaN</code>
</li>
<li>
<code>=ADD("foo")</code> → <code>fooundefined</code>
</li>
<li>
<code>=ADD(A1, A2)</code> → <code>A1A2</code>
</li>
</ul>

<p>In other words, if you use this raw form, you are responsible for type-checking the arguments and your primitive is always expected to be asynchronous.</p>

<h2 id="see-also"><a href="#see-also">See Also</a></h2>

<p>Other articles on the Kendo UI Spreadsheet:</p>

<ul>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/overview">Overview</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/format">Cell Formatting</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/custom-editors">Custom Cell Editors</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/import-and-export-data/json">Store Data as JSON</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/import-and-export-data/export-to-excel">Export to Excel</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/import-and-export-data/server-side-processing">Server-Side Processing</a></li>
<li><a href="/docs-kendo-china/controls/data-management/spreadsheet/end-user/user-guide">User Guide</a></li>
</ul> 
        </article>
    </div>
    <div id="feedback-container">
  <div id="feedback-section">
    <script src="/docs-kendo-china/assets/feedback.js?cb=e99a3802c754fe2425831d58312c7c8b"></script>
    <span id="popupNotification"></span>
    <div id="feedback-menu-container">
      <div id="helpful-buttons-container">
        <span class="side-title">Is this article helpful?</span>
        <a class="button" id="yesButton">Yes</a> /
        <a class="button" id="noButton">No</a>
      </div>
      <div id="feedback-submitted-container">
        <span class="side-title">Thank you for your feedback!</span>
      </div>
    </div>
    <div id="feedback-window-container">
      <div id="feedback-form-window" style="background-color: white;">
        <h1 class="feedback-extw__title">Give article feedback</h1>
        <p>Tell us how we can improve this article</p>
        <span id="feedback-form-popup-container"></span>
        <form id="feedback-form">
          <div id="feedback-checkbox-area">
            <input id="hidden-sheet-id" type="hidden" value="14zzclhdh7dMLpg0iq4-2hweCdEiuxxqP3tHdr42-_Cs">
            <label>
              <input type="checkbox" data-bind="checked: outdatedSample" /> Code samples are inaccurate / outdated.
            </label>
            <span class="required-field" data-bind="visible: outdatedSample"></span>
            <textarea id="feedback-code-sample-text-input" placeholder="Please, specify more details ..." class="feedback-extw__textarea"
              data-bind="visible: outdatedSample, value: inaccurateOutdatedCodeSamplesText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: otherMoreInformation" /> I expected to find other / more information.
            </label>
            <span class="required-field" data-bind="visible: otherMoreInformation"></span>
            <textarea id="feedback-more-information-text-input" class="feedback-extw__textarea" placeholder="Please, specify what information can be added ..."
              data-bind="visible: otherMoreInformation, value: otherMoreInformationText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: textErrors" /> There are typos / broken links / broken page elements.
            </label>
            <span class="required-field" data-bind="visible: textErrors"></span>
            <textarea id="feedback-text-errors-text-input" class="feedback-extw__textarea" placeholder="Please, specify what needs to be fixed ..."
              data-bind="visible: textErrors, value: typosLinksElementsText">
          </textarea>
            <label>
              <input type="checkbox" data-bind="checked: inaccurateContent" /> Content is inaccurate / outdated.
            </label>
            <span class="required-field" data-bind="visible: inaccurateContent"></span>
            <textarea id="feedback-inaccurate-content-text-input" class="feedback-extw__textarea" placeholder="Please, specify which conent ..."
              data-bind="visible: inaccurateContent, value: inaccurateOutdatedContentText"></textarea>
            <label>
              <input type="checkbox" data-bind="checked: otherFeedback" /> Other
            </label>
            <span class="required-field" data-bind="visible: otherFeedback"></span>
            <textarea id="feedback-other-text-input" placeholder="Please, enter more details or not listed feedback ..." class="feedback-extw__textarea"
              data-bind="visible: otherFeedback, value: textFeedback">
          </textarea>
            <input id="feedback-email-input" type="email" placeholder="email (optional)" data-email-msg="Email format is not valid."
              class="feedback-extw__input input" data-bind="value: email" />
          </div>
        </form>
        <div class="feedback-extw__foot">
          <button id="form-submit-button" class="feedback-extw__button button button--action">Send feedback</button>
          <button id="form-close-button" class="feedback-extw__button button">Cancel</button>
        </div>
      </div>
    </div>
    <a id="close-button" class="button">
      <img src="/docs-kendo-china/images/close-btn.svg" alt="close" />
    </a>
  </div>
  <div id="feedback-section-dummy">Dummy</div>
</div>
    <footer>
    <p>Copyright &copy; 2017 Progress Software Corporation and/or its subsidiaries or affiliates. All Rights Reserved.</p>
</footer>

</div>
    </body>
</html>

